

	<h2 class="text-center" style="padding-top:60px">Counting IM</h2>
<div class="margin-top-20" style="padding:30px 0 10px 0" ng-if="!docNo">
	<div class="margin-top-20 col-sm-8 col-sm-offset-2" >
	 <form role="form" name="toNoForm">
	  <div class="form-group">
	    <label for="docNo">Please scan/enter a Doc Number:</label>
		<input type="text" class="form-control" id="docNo" placeholder="scan/enter Doc No" 
			   ng-model="piDoc.docNo" focus-me="!piDoc.docNo&&true">
	  </div>
	  <div class="form-group">
	    <label for="woNo">Please scan/enter Fiscal Year:</label>
		<input type="text" class="form-control" id="fiscalYear" placeholder="scan/enter fiscal year" 
			   ng-model="piDoc.fiscalYear" focus-me="false">
	  </div>
	  
	  <button type="submit" class="btn btn-default" ng-click="submitForm()">Submit</button>
	</form>
  </div>
  </div>


  <div ng-init="showTab='docDetail'" class=" col-sm-12 padding-top-20" ng-if="docNo" >
  <!-- Nav tabs -->
  <ul class="nav nav-tabs " role="tablist">
		<li role="presentation" ng-class="{'active':showTab==='docDetail'}"><a class="cursor-pointer" 
				ng-click="showTab='docDetail'">Document Detail</a></li>
		<li role="presentation" ng-class="{'active':showTab==='scanItem'}" ng-show="piDoc.items.length>0">
			<a class="cursor-pointer"  ng-click="showTab='scanItem'">Counting Scan</a>
		</li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
    <div role="tabpanel" class="tab-pane"  ng-class="{'active':showTab==='docDetail'||piDoc.items.length===0}" id="counting">
    	
		  <table class="table padding-top margin-top table-striped">
		  	<thead> 
		  		<tr> 
		  			<th  class="text-center" colspan="2" ng-show="piDoc.items.length>0">
							<!-- <span>Selected HU:{{temp.showHUIdx+1}} of {{piDoc.items.length}} </span>
							<span class="margin-left">HU Number: {{temp.showHU.HUNumber}}</span> -->
					</th> 
		  		</tr> 
		  	</thead> 
		  	<tbody> 
		  		<tr> 
		  			<td >Document No.</td> 
		  			<td>{{piDoc.docNo}}</td>
		  		</tr>
		  		<tr> 
		  			<td >Fiscal Year</td> 
		  			<td>{{piDoc.fiscalYear}}</td>
		  		</tr>
		  		<tr> 
		  			<td >Count Status</td> 
		  			<td>{{(piDoc.CountStatus)?'Counted':'Open'}}</td>
		  		</tr>
		  		<tr> 
		  			<td >Created By</td> 
		  			<td>{{piDoc.userName}}</td>
		  		</tr> 
		  		<tr> 
		  			<td >Created On</td> 
		  			<td>{{piDoc.DocDate|ymdDate:"dd MMM yyyy"}}</td>
		  		</tr> 
		  		
		  		<tr> 
		  			<td >Plant</td> 
		  			<td>{{piDoc.Plant}}</td>
		  		</tr> 

		  		<tr> 
		  			<td >Number of Items</td> 
		  			<td>{{(piDoc.items.length||0)+(piDoc.extraItems.length||0)}}</td>
		  		</tr> 
		  		
		  	</tbody> 
		  </table>
    </div>
    <div role="tabpanel" class="tab-pane padding-top" ng-class="{'active':showTab==='scanItem'}" id="scanItem"  ng-if="piDoc.items.length>0">
			<!-- <span scan-items info="info"></span> -->
			<div ng-include src="'partials/scan-input.html'"></div>

			<div ng-init="showScanItemTab='totalSummary'" class="full-width">
				<!-- Nav tabs -->
				<ul class="nav nav-tabs " role="tablist">
					  <li role="presentation" ng-class="{'active':showScanItemTab==='totalSummary'||piDoc.items.length===0}"><a class="cursor-pointer" 
							  ng-click="showScanItemTab='totalSummary'">Total Summary</a></li>
					  <li role="presentation" ng-class="{'active':showScanItemTab==='itemView'}" ng-show="piDoc.items.length>0||piDoc.scannedItems">
								  <a class="cursor-pointer" ng-click="showScanItemTab='itemView'">Box Summary</a>
					  </li>
					  <button type="button" class="btn btn-default pull-right" ng-click="refreshScannedItems();setFocus('barcode1')">Refresh</button>
				</ul>
			  
				<!-- Tab panes -->
				<div class="tab-content">
					<!-- Total Summary start -->
				  <div role="tabpanel" class="tab-pane"  ng-class="{'active':showScanItemTab==='totalSummary'}" id="totalSummary">
						<div class="margin-top-20 panel-head">
									<div class="col-sm-2 col-xs-2">Line No</div>
									<div class="col-sm-3 col-xs-3">Item No</div>
									<div class="col-sm-2 col-xs-2">Material</div>
									<div class="col-sm-2 col-xs-2">Batch No</div>
									<div class="col-sm-3 col-xs-3">Scan Qty</div>									
						</div>
						<div class="clearboth"></div>
						<accordion close-others="true" >
							<div accordion-group class="panel-default scan-item"  
										ng-repeat="(pidx,item) in piDoc.items track by pidx" >
								<accordion-heading>
									<table class="full-width">
										<tr>
											<td width="16%" class="text-center">{{pidx+1}}</td>
											<td width="21%" class="text-center">{{item.item}}</td>
											<td width="21%" class="text-center">{{item.MaterialCode}}</td>
											<td width="21%" class="text-center">{{item.BatchNo}}</td>
											<td width="21%" class="text-center">{{item.ScanQty}}</td>
										</tr>
									</table>
								</accordion-heading>
							</div>
							<div accordion-group class="panel-default scan-item warn"  
											ng-repeat="(pidx,item) in piDoc.extraItems track by pidx" >
									<accordion-heading>
										<table class="full-width">
											<tr>
												<td width="16%" class="text-center">{{pidx+piDoc.items.length+1}}</td>
												<td width="21%" class="text-center">{{item.item||'-'}}</td>
												<td width="21%" class="text-center">{{item.MaterialCode}}</td>
												<td width="21%" class="text-center">{{item.BatchNo}}</td>
												<td width="21%" class="text-center">{{item.ScanQty||0}}</td>
											</tr>
										</table>
									</accordion-heading>
								</div>
							<dir class="clearboth"></dir>
						</accordion>
				  </div>
				  <!-- Total Summary end -->
				  <!-- Box Summary start -->
				  <div role="tabpanel" class="tab-pane" ng-class="{'active':showScanItemTab==='itemView'}" id="itemView">
						<form ng-show="piDoc.items&&piDoc.items.length>0" class="margin-top">
							<div class="form-group">
								<div class="input-group">
								<div class="input-group-addon"><i class="fa fa-search"></i></div>
								<input type="text" class="form-control" placeholder="Search item" ng-model="searchItem">
								</div>      
							</div>
						</form>
						<table class="table padding-top table-striped border">
							<thead> 
								<tr>
									
								<td>
									<a class="cursor-pointer" ng-click="sortType = itemNoFieldName; sortReverse = !sortReverse">
									Item Number
									<span ng-show="sortType == itemNoFieldName && !sortReverse" class="fa fa-caret-down"></span>
									<span ng-show="sortType == itemNoFieldName && sortReverse" class="fa fa-caret-up"></span>
									</a>
								</td>
								<td>
									<a class="cursor-pointer" ng-click="sortType = 'MaterialCode'; sortReverse = !sortReverse">
									Material
									<span ng-show="sortType == 'MaterialCode' && !sortReverse" class="fa fa-caret-down"></span>
									<span ng-show="sortType == 'MaterialCode' && sortReverse" class="fa fa-caret-up"></span>
									</a>
								</td>
								<td>
									<a class="cursor-pointer" ng-click="sortType = 'BatchNo'; sortReverse = !sortReverse">
									Batch No 
									<span ng-show="sortType == 'BatchNo' && !sortReverse" class="fa fa-caret-down"></span>
									<span ng-show="sortType == 'BatchNo' && sortReverse" class="fa fa-caret-up"></span>
									</a>
								</td>
									<td>
									<a class="cursor-pointer" ng-click="sortType = 'SerialNo'; sortReverse = !sortReverse">
									Serials No
									<span ng-show="sortType == 'SerialNo' && !sortReverse" class="fa fa-caret-down"></span>
									<span ng-show="sortType == 'SerialNo' && sortReverse" class="fa fa-caret-up"></span>
									</a>
								</td>
								<td>
									<a class="cursor-pointer" ng-click="sortType = 'ScanQty'; sortReverse = !sortReverse">
									Qty
									<span ng-show="sortType == 'ScanQty' && !sortReverse" class="fa fa-caret-down"></span>
									<span ng-show="sortType == 'ScanQty' && sortReverse" class="fa fa-caret-up"></span>
									</a>
								</td>
								<td width="10%" class="text-center">Action</td>
									
								</tr>
							</thead> 
							<tbody> 
								<tr ng-if=" piDoc.items&& piDoc.items.length>0" 
									ng-repeat="(idx,item) in piDoc.scannedItems | orderBy:sortType:sortReverse | filter:searchItem">
			
								<td>{{item.itemNo||'-'}}</td>
								<td>{{item.MaterialCode}}</td>
								<td>{{item.BatchNo}}</td>
								<td>{{item.SerialNo}}</td>
								<td>{{item.ScanQty||1}}</td>
								<td width="10%" class="text-center">
									<a class="cursor-pointer margin-left-20 text-danger"  
										confirm-required="item {{item.serialNo||item.SerialNo}}" 
										ng-click="removeItem(item)">
										<i class="text-danger fa fa-times-circle fa-lg"></i>
									</a>
								</td>
			
							</tr>
							<tr ng-if="!piDoc.scannedItems||piDoc.scannedItems.length==0">
								<td colspan="6" class='empty-message'>No item.</td>
							</tr>
							</tbody> 
						</table>
					  
					</div>
					<!-- Box Summary end -->
					
				  <div class="clearboth"></div>
				</div>
			  </div>
    	
    </div>
	  <!--confirm button-->
	  <div class="col-sm-4 col-xs-12 no-padding-x text-right margin-top">
		  <button type="button" class="col-xs-12 btn btn-primary btn-md" confirm-required action="confirm counting" 
		  ng-click="confirmCounting()" ng-disabled="{{piDoc.CountStatus.length}}">
		  <span class="glyphicon glyphicon-star" aria-hidden="true"></span> Confirm Counting
		</button>
	</div>
	<div class="clearboth"></div>
  </div>

</div>
<div class="clearboth"></div>
<pre ng-if="debug">barcode:{{barcode | json}}</pre>	
<pre ng-if="debug">piDoc:{{piDoc|json}}</pre>	
<!-- <pre ng-show="debug">categories:{{categories | json}}</pre>	 -->